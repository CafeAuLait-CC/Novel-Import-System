# Novel Import System
A system that maintains a database of writers and their novel information. To access the database, talk to it!

#### Key features:

- import data from text file;
- CLI user interface;
- create/delete/update/list data records by answering questions;
- access the database using custom SQL queries.


## Table of Content:
	
- [System Environment](#system-environment)
- [File Structure](#file-structure)
- [Compile & Run](#compile--run)
- [Text Data Files](#text-data-files)
- [Usage](#usage)
- [Example](#example)
- [Known Issues](#known-issues)
	

## System Environment

### Environment

- Windows 10
- Java 8
- Apache Derby (version 10.14.2.0)

### Configuration

Environment Variables needs to be set for both Java and Derby. Including:

- `JAVA_HOME`
- `DERBY_HOME`
- `CLASSPATH` for both Java and Derby


## File Structure

- The folder structure shown as follow:
	
		- Source code files:      ./src/*.java
		- External .jar:          ./ext/derby.jar
		- Text data files:        ./text_data/writers.txt, ./text_data/books.txt
		- Other text files:       ./README.txt, ./TESTCASES.txt
		- Java .class file:       ./assignment/*.class  ---- generated by 'javac' command
		- Derby DB files:         ./mydb/*              ---- generated by the program
	

## Compile & Run

1. Open cmd / PowerShell and go to this `Novel Import System\` folder;

2. Compile: 

	``` 
	> javac -d . .\src\assignment\*.java 
	```
3. Run: 

	```
	> java assignment.NovelImportSystem
	```

	**Note:** If the environment variables are not set, or for some other reasons the program can not link to the derby library, try the following command:
	
	```
	(Powershell)     > java -cp .\ext\derby.jar`; assignment.NovelImportSystem
	(Command Prompt) > java -cp .\ext\derby.jar; assignment.NovelImportSystem
	``` 

## Text Data Files

There are two text files in the root folder, `books.txt` and `writers.txt`.

When the program starts, it will first read these two text files and insert the data into the database.

The file formats are shown as below:


### books.txt

| Title  | Author | Publisher | Publish Date | Edition | ISBN10     | ISBN13        | Amazon Rank | Genre |
|:-------|:-------|:----------|:------------:|:-------:|:----------:|:-------------:|:-----------:|:------|
| Title1 | Auth 1 | Publi. 1  | Jan-01-2001  | 1st     | 1234567890 | 1234567890123 |       1     | Genr1 |
| Title2 | Auth 2 | Publi. 2  | Feb-02-2002  | 2nd     | 2345678901 | 2345678901234 |       2     | Genr2 |
| Title3 | Auth 3 | Publi. 3  | Mar-03-2003  | 3rd     | 3456789012 | 3456789012345 |       3     | Genr3 |
| Title4 | Auth 4 | Publi. 4  | Aprl-04-2004 | unknown | 4567890123 | 4567890123456 |       4     | Genr4 |


### writers.txt

|  Name  | Date of Birth | Nationality | alma Meter | Occupation |
|:-------|:-------------:|:-----------:|:----------:|:-----------|
| Writr1 |  Jan-01-1911  |   Country1  | College1   |  Occupat 1 |
| Writr2 |  Jan-01-1921  |   Country2  | College2   |  Occupat 2 |
| Writr3 |  Jan-01-1931  |   Country3  | College3   |  Occupat 3 |


## Usage

The program can run on 5 modes, depending on the user input: Add, Delete, Update, List and Custom mode.

- **Add mode:** In this mode, the program can help you to insert a new writer or book record into the database, in an interactive way;

- **Delete mode:** In this mode, the program can help you to delete an existing writer or book record from the database;

- **Update mode:** In this mode, the program can help you to update writer or book records in the database;

- **List mode:** In this mode, you can search and print the expected records in the database;

- **Custom mode:** In this mode, the program provides a command line environment where you can type custom SQL queries and interact with the database.



## Example

This section will show you a complete example of how to list expected record step by step using the list mode.

1. Run the program with `java assignment.NovelImportSystem`, it will print info as the following:

	```
    directory\to\the\project\ > java assignment.NovelImportSystem
	- Reading book info from text file...
	- Executing SQL: create table books (Title varchar(100), ..., Genre varchar(50))
	- Table 'BOOKS' created!

	- Reading writer info from text file...
	- Executing SQL: create table writers (Name varchar(100), ..., Occupation varchar(100))
	- Table 'WRITERS' created!

	$ Please enter (a)dd/(d)elete/(u)pdate/(l)ist/(c)ustom/exit to continue...
	$ 
	```

2. Type `list` or `l`, then press `ENTER`:

	```
	$ Please enter (a)dd/(d)elete/(u)pdate/(l)ist/(c)ustom/exit to continue...
	$ list
	(List) What do you want to check? Please select a number from below. ("quit" to quit list mode)
	1. List the writers records.
	2. List the books records.
	3. More options, jump to custom mode!
	(List) >> 
	```

3. To check records from books, type `2` and press `ENTER`:

	```
	(List) What do you want to check? Please select a number from below. ("quit" to quit list mode)
	1. List the writers records.
	2. List the books records.
	3. More options, jump to custom mode!
	(List) >> 2
	(List) This table have the following columns:
	TITLE   AUTHOR  PUBLISHER       DATE    EDITION ISBN10  ISBN13  RANKING GENRE

	(List) Which columns do you want to see in this table? Enter "all" to show all columns. (Separate by ",")
	(List) >>
	```

4. The program will tell you the `header` of this table, so that you can them as keys for searching. As an example, if you only want to see the *book title*, *author name* and *ISBN-13 code*, type `title, author, isbn13`:

	```
	(List) Which columns do you want to see in this table? Enter "all" to show all columns. (Separate by ",")
	(List) >> title, author, isbn13
	(List) Are you looking for specific column values? (Enter "column name, value", or "No" to skip) (Separate by ",")
	(List) >>
	```

	Then the program will ask you wether you want to add a filter into the search query. To display all books writen by Tolkien:

5. Type `author, 'J.R.R.Tolkien'`: 

	Please note that the `value` in the **(**`column_name`, `value`**)** pair must be written in quotation marks!

	```
	(List) Are you looking for specific column values? (Enter "column name, value", or "No" to skip) (Separate by ",")
	(List) >> author, 'J.R.R.Tolkien'
	executing:
	select title, author, isbn13 from books where author='J.R.R.Tolkien'
	TITLE                    AUTHOR                   ISBN13
	The Lord of the Ring...  J.R.R.Tolkien         978-0008471286

	Letters from Father ...  J.R.R.Tolkien         978-0008406844

	The Hobbit               J.R.R.Tolkien         978-0261103283

	Mr Bliss                 J.R.R.Tolkien         978-0007436194

	"The Hobbit, or Ther...  J.R.R.Tolkien         978-0261102002

	(List) What do you want to check? ("quit" to quit list mode)
	1. List the writers records.
	2. List the books records.
	3. More options, jump to custom mode!
	(List) >>
	```

	Now the program will display the books written by Tolkien and their ISBN-13 code, and one search is complete!

6. Type `quit` will go back to the main program again, then type `exit` to exit the program:

	```
	$ Please enter (a)dd/(d)elete/(u)pdate/(l)ist/(c)ustom/exit to continue...
	$ exit

	*** Program terminated. Bye bye! ****
	```

*For more details, please check the* `TESTCASES.txt` *, thank you!*


## Known Issues

- When program is asking for user input, **DO NOT** enter a single value with `,` inside, 
	
	for example a book title `"Hello, world"` will be treated as two strings `"Hello"` and `"world"`, instead of a single book title string.

	This is because the program is parsing the user input using ',' as a command separator.


- The two tables `WRITERS` and `BOOKS` are not yet in sync.

	For now, when adding a new book into the `BOOKS` table, if the author of this book does not exist in the `WRITERS` table, the author info won't be inserted to the `WRITERS` table automatically.
